[build]
builder = "nixpacks"
buildCommand = "pip install -r requirements.txt"

[deploy]
healthcheckPath = "/monitoring/health/"
healthcheckTimeout = 300
restartPolicyType = "ON_FAILURE"
startCommand = "python manage.py migrate && python manage.py create_admin && python manage.py collectstatic --noinput && gunicorn --bind 0.0.0.0:$PORT cfmp.wsgi:application"

[environments.production]
[environments.production.variables]
DJANGO_SETTINGS_MODULE = "cfmp.settings"
DJANGO_ENVIRONMENT = "production"
DEBUG = "False"
SECRET_KEY = "your-production-secret-key-here"
ALLOWED_HOSTS = "localhost,127.0.0.1,.railway.app,healthcheck.railway.app"